<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Sistema Solar 3D Realista PRO + Radar Interactivo</title>
<style>
body{margin:0;overflow:hidden;background:black;font-family:Arial}
#info{
  position:absolute;top:10px;left:10px;
  color:white;background:rgba(0,0,0,.6);
  padding:10px;border-radius:6px;z-index:2
}
#radar{
  position:absolute;top:10px;right:10px;
  width:250px;height:250px;
  background:rgba(0,0,0,.6);
  border:2px solid #0f0;
  border-radius:50%;
  z-index:3;
  cursor:pointer;
  transition: all 0.3s ease;
}
#radar.grande{
  width:400px;height:400px;
}
#radarInfo{
  position:absolute;top:270px;right:10px;
  color:#0f0;background:rgba(0,0,0,.6);
  padding:6px;border-radius:6px;font-size:12px;z-index:3;
  max-width:400px;
}
</style>
</head>
<body>

<div id="info">WASD mover · Ratón mirar · Q/E subir/bajar</div>
<canvas id="radar"></canvas>
<div id="radarInfo">Cerca de: —</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/PointerLockControls.js"></script>

<script>
// ==================== ESCENA ====================
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(75, innerWidth/innerHeight, .1, 200000);
camera.position.set(0, 500, 1800);

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth, innerHeight);
renderer.setPixelRatio(window.devicePixelRatio);
document.body.appendChild(renderer.domElement);

// ==================== TEXTURAS ====================
const loader = new THREE.TextureLoader();
const textures = {
  Sol:"https://i.postimg.cc/zGW5FLW0/sol.png",
  Mercurio:"https://i.postimg.cc/jSqQzfBG/mercurio.png",
  Venus:"https://i.postimg.cc/Znh60vrX/venus.png",
  Tierra:"https://i.postimg.cc/wTp1NdS6/image.png",
  Marte:"https://i.postimg.cc/x8S1LKp4/marte-textura.png",
  Júpiter:"https://i.postimg.cc/W3mvLxSq/jupiter_textura.png",
  Saturno:"https://i.postimg.cc/T1Wn3qLQ/saturno.png",
  AnillosSaturno:"https://i.postimg.cc/SNXStZ8C/aros.png",
  Urano:"https://i.postimg.cc/dVFNgDp8/urano.png",
  Neptuno:"https://i.postimg.cc/HxFBzLb0/neptuno.png",
  Pluton:"https://i.postimg.cc/sDBswhc5/pluton.png",
  Luna:"https://i.postimg.cc/7hfrGbwg/luna.png"
};

// ==================== LUZ ====================
const sunLight = new THREE.PointLight(0xffffff,3,0);
scene.add(sunLight);

// ==================== SOL ====================
const sun = new THREE.Mesh(
  new THREE.SphereGeometry(60,64,64),
  new THREE.MeshBasicMaterial({map: loader.load(textures.Sol)})
);
scene.add(sun);

// Glow del sol
const glowTexture = new THREE.TextureLoader().load("https://threejs.org/examples/textures/lensflare/lensflare0.png");
const glowMat = new THREE.SpriteMaterial({map:glowTexture,color:0xffddaa,transparent:true,blending:THREE.AdditiveBlending,depthWrite:false});
const glow = new THREE.Sprite(glowMat);
glow.scale.set(500,500,1);
sun.add(glow);

// ==================== ESTRELLAS ====================
(function(){
  const g = new THREE.BufferGeometry();
  const v = [];
  for(let i=0;i<70000;i++){
    const r = 20000 + Math.random()*20000;
    const t = Math.random()*Math.PI*2;
    const p = Math.acos(THREE.MathUtils.randFloatSpread(2));
    v.push(r*Math.sin(p)*Math.cos(t), r*Math.sin(p)*Math.sin(t), r*Math.cos(p));
  }
  g.setAttribute("position", new THREE.Float32BufferAttribute(v,3));
  scene.add(new THREE.Points(g, new THREE.PointsMaterial({size:1})));
})();

// ==================== CREAR PLANETA ====================
function crearPlaneta(nombre,opt){
  const mesh = new THREE.Mesh(
    new THREE.SphereGeometry(opt.radio,48,48),
    new THREE.MeshStandardMaterial({map:loader.load(textures[nombre])})
  );
  mesh.userData = {
    distancia: opt.distancia,
    angulo: Math.random()*Math.PI*2,
    velOrb: opt.velOrb,
    velRot: opt.velRot,
    nombre: nombre
  };
  scene.add(mesh);
  return mesh;
}

// ==================== PLANETAS (Separación más realista) ====================
const mercurio = crearPlaneta("Mercurio",{radio:4,distancia:150,velOrb:.00005,velRot:.001});
const venus    = crearPlaneta("Venus",{radio:7,distancia:220,velOrb:.00004,velRot:.0008});
const tierra   = crearPlaneta("Tierra",{radio:8,distancia:300,velOrb:.000035,velRot:.001});
const marte    = crearPlaneta("Marte",{radio:5,distancia:380,velOrb:.00003,velRot:.0009});
const jupiter  = crearPlaneta("Júpiter",{radio:18,distancia:480,velOrb:.00002,velRot:.002});
const saturno  = crearPlaneta("Saturno",{radio:16,distancia:580,velOrb:.000015,velRot:.0015});
const urano    = crearPlaneta("Urano",{radio:13,distancia:650,velOrb:.000012,velRot:.0012});
const neptuno  = crearPlaneta("Neptuno",{radio:13,distancia:720,velOrb:.00001,velRot:.001});
const pluton   = crearPlaneta("Pluton",{radio:6,distancia:800,velOrb:.000008,velRot:.0007});

// ==================== INCLINACIONES ====================
tierra.rotation.z=.41;
marte.rotation.z=.44;
jupiter.rotation.z=.05;
saturno.rotation.z=.47;
urano.rotation.z=1.71;
neptuno.rotation.z=.49;

// ==================== LUNA TIERRA ====================
function crearLuna(planeta,dist,vel){
  const l = new THREE.Mesh(
    new THREE.SphereGeometry(2,24,24),
    new THREE.MeshStandardMaterial({map:loader.load(textures.Luna)})
  );
  l.userData = {orbita:planeta,distancia:dist,velocidad:vel,angulo:Math.random()*Math.PI*2,nombre:"Luna"};
  scene.add(l);
  return l;
}
const lunaTierra = crearLuna(tierra,14,.01);

// ==================== ANILLOS SATURNO MÁS INCLINADOS ====================
const ringSatGeometry = new THREE.RingGeometry(18,26,128);
const ringSatMaterial = new THREE.MeshBasicMaterial({
  map: loader.load(textures.AnillosSaturno),
  side: THREE.DoubleSide,
  transparent: true
});
const ringSat = new THREE.Mesh(ringSatGeometry, ringSatMaterial);
ringSat.rotation.x = Math.PI/2 + 0.2; // inclinación extra
ringSat.rotation.z = .45;
scene.add(ringSat);

// ==================== CINTURONES ====================
(function(){const g=new THREE.Group();for(let i=0;i<3500;i++){const m=new THREE.Mesh(new THREE.IcosahedronGeometry(Math.random()*.6+.2),new THREE.MeshStandardMaterial({color:0x777777}));const a=Math.random()*Math.PI*2;const r=430+Math.random()*40;m.position.set(Math.cos(a)*r,THREE.MathUtils.randFloatSpread(20),Math.sin(a)*r);g.add(m);}scene.add(g);})();
(function(){const g=new THREE.Group();for(let i=0;i<2500;i++){const m=new THREE.Mesh(new THREE.DodecahedronGeometry(Math.random()*.7+.25),new THREE.MeshStandardMaterial({color:0x888888}));const a=Math.random()*Math.PI*2;const r=820+Math.random()*150;m.position.set(Math.cos(a)*r,THREE.MathUtils.randFloatSpread(40),Math.sin(a)*r);g.add(m);}scene.add(g);})();

// ==================== VOYAGER ====================
function crearVoyager(nombre,dist,angulo,color){
  const v=new THREE.Mesh(new THREE.BoxGeometry(3,3,6),new THREE.MeshBasicMaterial({color}));
  v.userData={distancia:dist,angulo,vel:.00002,nombre};
  scene.add(v);
  return v;
}
const voyager1=crearVoyager("Voyager 1",1200,1.5,0x00ffff);
const voyager2=crearVoyager("Voyager 2",1100,2.7,0xff00ff);
const naves=[voyager1,voyager2];

// ==================== CONTROLES ====================
const controls = new THREE.PointerLockControls(camera,document.body);
document.body.addEventListener("click",()=>controls.lock());
const move={f:false,b:false,l:false,r:false,u:false,d:false};
document.addEventListener("keydown", e => {if(e.code==="KeyW")move.f=true;if(e.code==="KeyS")move.b=true;if(e.code==="KeyA")move.l=true;if(e.code==="KeyD")move.r=true;if(e.code==="KeyE")move.u=true;if(e.code==="KeyQ")move.d=true;});
document.addEventListener("keyup", e => {if(e.code==="KeyW")move.f=false;if(e.code==="KeyS")move.b=false;if(e.code==="KeyA")move.l=false;if(e.code==="KeyD")move.r=false;if(e.code==="KeyE")move.u=false;if(e.code==="KeyQ")move.d=false;});

// ==================== RADAR INTERACTIVO ====================
const radar = document.getElementById("radar");
const ctx = radar.getContext("2d");
const radarInfo = document.getElementById("radarInfo");
let radarGrande = false;
radar.addEventListener("click",()=>{radarGrande = !radarGrande; radar.classList.toggle("grande");});

// ==================== FUNCIONES RADAR ====================
function dibujarRadar(){
  const r = radarGrande ? 200 : 120;
  const cx = radarGrande ? 200 : 125;
  const cy = radarGrande ? 200 : 125;
  ctx.clearRect(0,0,radar.width,radar.height);

  // círculo exterior
  ctx.strokeStyle="#0f0"; ctx.beginPath(); ctx.arc(cx,cy,r,0,Math.PI*2); ctx.stroke();

  // órbitas
  ctx.strokeStyle="rgba(0,255,0,0.3)";
  [mercurio,venus,tierra,marte,jupiter,saturno,urano,neptuno,pluton].forEach(p=>{ctx.beginPath();ctx.arc(cx,cy,p.userData.distancia*0.08,0,Math.PI*2);ctx.stroke();});

  // jugador
  ctx.fillStyle="#00ff00"; ctx.fillRect(cx-2,cy-2,4,4);

  let masCercano="—"; let minDist=Infinity;
  function plot(obj,color){
    const x = cx + obj.position.x*0.08;
    const y = cy + obj.position.z*0.08;
    ctx.fillStyle=color; ctx.fillRect(x,y,3,3);
    const d=camera.position.distanceTo(obj.position); if(d<minDist){minDist=d;masCercano=obj.userData.nombre;}
  }
  [mercurio,venus,tierra,marte,jupiter,saturno,urano,neptuno,pluton,lunaTierra].forEach(p=>plot(p,"white"));
  naves.forEach(n=>plot(n,"cyan"));
  radarInfo.textContent = `Cerca de: ${masCercano} | Posición X:${Math.round(camera.position.x)} Y:${Math.round(camera.position.y)} Z:${Math.round(camera.position.z)}`;
}

// ==================== ANIMACIÓN ====================
function animate(){
  requestAnimationFrame(animate);

  const s=6;
  if(move.f)controls.moveForward(s);
  if(move.b)controls.moveForward(-s);
  if(move.l)controls.moveRight(-s);
  if(move.r)controls.moveRight(s);
  if(move.u)camera.position.y+=s;
  if(move.d)camera.position.y-=s;

  // órbitas planetas
  [mercurio,venus,tierra,marte,jupiter,saturno,urano,neptuno,pluton].forEach(p=>{
    p.userData.angulo+=p.userData.velOrb;
    p.position.x=Math.cos(p.userData.angulo)*p.userData.distancia;
    p.position.z=Math.sin(p.userData.angulo)*p.userData.distancia;
    p.rotation.y+=p.userData.velRot;
  });

  // luna
  lunaTierra.userData.angulo+=lunaTierra.userData.velocidad;
  const o=tierra.position;
  lunaTierra.position.x=o.x+Math.cos(lunaTierra.userData.angulo)*lunaTierra.userData.distancia;
  lunaTierra.position.z=o.z+Math.sin(lunaTierra.userData.angulo)*lunaTierra.userData.distancia;

  // anillo saturno
  ringSat.position.copy(saturno.position);

  // voyager
  naves.forEach(v=>{v.userData.angulo+=v.userData.vel; v.position.x=Math.cos(v.userData.angulo)*v.userData.distancia; v.position.z=Math.sin(v.userData.angulo)*v.userData.distancia;});

  dibujarRadar();
  renderer.render(scene,camera);
}
animate();

// ==================== RESIZE ====================
addEventListener("resize",()=>{camera.aspect=innerWidth/innerHeight;camera.updateProjectionMatrix();renderer.setSize(innerWidth,innerHeight);});
</script>

</body>
</html>
