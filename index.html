<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Sistema Solar PRO + Voyager + Radar</title>
<style>
body{margin:0;overflow:hidden;background:black;font-family:Arial}

/* info */
#info{
  position:absolute;top:10px;left:10px;
  color:white;background:rgba(0,0,0,.6);
  padding:10px;border-radius:6px;z-index:2
}

/* radar */
#radar{
  position:absolute;
  top:10px;
  right:10px;
  width:200px;
  height:200px;
  background:rgba(0,0,0,.6);
  border:2px solid #0f0;
  border-radius:50%;
  z-index:3;
}
#radarInfo{
  position:absolute;
  top:220px;
  right:10px;
  color:#0f0;
  background:rgba(0,0,0,.6);
  padding:6px;
  border-radius:6px;
  font-size:12px;
  z-index:3;
}
</style>
</head>
<body>

<div id="info">WASD mover Â· RatÃ³n mirar Â· Q/E subir/bajar</div>
<canvas id="radar"></canvas>
<div id="radarInfo">Cerca de: â€”</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/PointerLockControls.js"></script>

<script>
// ================= ESCENA =================
const scene=new THREE.Scene();
const camera=new THREE.PerspectiveCamera(75,innerWidth/innerHeight,.1,100000);
camera.position.set(0,250,900);

const renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
document.body.appendChild(renderer.domElement);

const loader=new THREE.TextureLoader();

// ================= SOL =================
const sun=new THREE.Mesh(
new THREE.SphereGeometry(60,64,64),
new THREE.MeshBasicMaterial({color:0xffdd55})
);
scene.add(sun);

scene.add(new THREE.PointLight(0xffffff,3));

// ================= ESTRELLAS =================
(function(){
const g=new THREE.BufferGeometry();
const v=[];
for(let i=0;i<60000;i++){
v.push(
THREE.MathUtils.randFloatSpread(40000),
THREE.MathUtils.randFloatSpread(40000),
THREE.MathUtils.randFloatSpread(40000)
);
}
g.setAttribute("position",new THREE.Float32BufferAttribute(v,3));
scene.add(new THREE.Points(g,new THREE.PointsMaterial({size:1})));
})();

// ================= CREAR PLANETA =================
function crearPlaneta(nombre,radio,distancia,velOrb,velRot,anguloInicial){
const mesh=new THREE.Mesh(
new THREE.SphereGeometry(radio,48,48),
new THREE.MeshStandardMaterial({color:0xffffff*Math.random()})
);

mesh.userData={
nombre,
distancia,
angulo:anguloInicial, // ðŸ”¥ ya NO random
velOrb,
velRot
};

scene.add(mesh);
return mesh;
}

// ================= PLANETAS (Ã¡ngulos fijos) =================
const mercurio=crearPlaneta("Mercurio",4,160,.00005,.001,0.3);
const venus=crearPlaneta("Venus",7,230,.00004,.0008,1.1);
const tierra=crearPlaneta("Tierra",8,310,.000035,.001,2.0);
const marte=crearPlaneta("Marte",5,390,.00003,.0009,2.8);
const jupiter=crearPlaneta("JÃºpiter",18,480,.00002,.002,3.6);
const saturno=crearPlaneta("Saturno",16,560,.000015,.0015,4.2);
const urano=crearPlaneta("Urano",13,630,.000012,.0012,5.0);
const neptuno=crearPlaneta("Neptuno",13,700,.00001,.001,5.6);
const pluton=crearPlaneta("PlutÃ³n",6,780,.000008,.0007,6.1);

const planetas=[mercurio,venus,tierra,marte,jupiter,saturno,urano,neptuno,pluton];

// ================= VOYAGER =================
function crearVoyager(nombre,dist,angulo,color){
const v=new THREE.Mesh(
new THREE.BoxGeometry(3,3,6),
new THREE.MeshBasicMaterial({color})
);
v.userData={distancia:dist,angulo,vel:.00002,nombre};
scene.add(v);
return v;
}

const voyager1=crearVoyager("Voyager 1",1200,1.5,0x00ffff);
const voyager2=crearVoyager("Voyager 2",1100,2.7,0xff00ff);

const naves=[voyager1,voyager2];

// ================= CONTROLES =================
const controls=new THREE.PointerLockControls(camera,document.body);
document.body.addEventListener("click",()=>controls.lock());

const move={f:false,b:false,l:false,r:false,u:false,d:false};

document.addEventListener("keydown",e=>{
if(e.code==="KeyW")move.f=true;
if(e.code==="KeyS")move.b=true;
if(e.code==="KeyA")move.l=true;
if(e.code==="KeyD")move.r=true;
if(e.code==="KeyE")move.u=true;
if(e.code==="KeyQ")move.d=true;
});
document.addEventListener("keyup",e=>{
if(e.code==="KeyW")move.f=false;
if(e.code==="KeyS")move.b=false;
if(e.code==="KeyA")move.l=false;
if(e.code==="KeyD")move.r=false;
if(e.code==="KeyE")move.u=false;
if(e.code==="KeyQ")move.d=false;
});

// ================= RADAR =================
const radar=document.getElementById("radar");
const ctx=radar.getContext("2d");
const radarInfo=document.getElementById("radarInfo");

function dibujarRadar(){
ctx.clearRect(0,0,200,200);
ctx.strokeStyle="#0f0";
ctx.beginPath();
ctx.arc(100,100,95,0,Math.PI*2);
ctx.stroke();

// jugador
ctx.fillStyle="#00ff00";
ctx.fillRect(98,98,4,4);

let masCercano="â€”";
let minDist=Infinity;

function plot(obj,color){
const scale=.08;
const x=100+obj.position.x*scale;
const y=100+obj.position.z*scale;

ctx.fillStyle=color;
ctx.fillRect(x,y,3,3);

const d=camera.position.distanceTo(obj.position);
if(d<minDist){
minDist=d;
masCercano=obj.userData.nombre;
}
}

planetas.forEach(p=>plot(p,"white"));
naves.forEach(n=>plot(n,"cyan"));

radarInfo.textContent="Cerca de: "+masCercano;
}

// ================= ANIMACIÃ“N =================
function animate(){
requestAnimationFrame(animate);

// movimiento
const s=6;
if(move.f)controls.moveForward(s);
if(move.b)controls.moveForward(-s);
if(move.l)controls.moveRight(-s);
if(move.r)controls.moveRight(s);
if(move.u)camera.position.y+=s;
if(move.d)camera.position.y-=s;

// Ã³rbitas planetas
planetas.forEach(p=>{
p.userData.angulo+=p.userData.velOrb;
p.position.x=Math.cos(p.userData.angulo)*p.userData.distancia;
p.position.z=Math.sin(p.userData.angulo)*p.userData.distancia;
p.rotation.y+=p.userData.velRot;
});

// voyager
naves.forEach(v=>{
v.userData.angulo+=v.userData.vel;
v.position.x=Math.cos(v.userData.angulo)*v.userData.distancia;
v.position.z=Math.sin(v.userData.angulo)*v.userData.distancia;
});

dibujarRadar();
renderer.render(scene,camera);
}
animate();

// resize
addEventListener("resize",()=>{
camera.aspect=innerWidth/innerHeight;
camera.updateProjectionMatrix();
renderer.setSize(innerWidth,innerHeight);
});
</script>
</body>
</html>
