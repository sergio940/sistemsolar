<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Sistema Solar 3D Completo</title>
<style>
body { margin:0; overflow:hidden; background:black; }
#info{
  position:absolute; top:10px; left:10px;
  color:white; background:rgba(0,0,0,0.6);
  padding:10px; border-radius:6px; font-family:Arial;
  z-index:2;
}
#menuPlanetas{
  position:absolute; top:50px; left:10px;
  color:white; background:rgba(0,0,0,0.6);
  padding:10px; border-radius:6px; font-family:Arial;
  z-index:2;
}
button { margin:3px; cursor:pointer; }
</style>
</head>
<body>

<div id="info">WASD = mover, Q/E = bajar/subir, Ratón = mirar.</div>
<div id="menuPlanetas">
  <button onclick="irSistemaSolar()">Sistema Solar Completo</button>
  <button onclick="irPlaneta(mercurio)">Mercurio</button>
  <button onclick="irPlaneta(venus)">Venus</button>
  <button onclick="irPlaneta(tierra)">Tierra</button>
  <button onclick="irPlaneta(marte)">Marte</button>
  <button onclick="irPlaneta(jupiter)">Júpiter</button>
  <button onclick="irPlaneta(saturno)">Saturno</button>
  <button onclick="irPlaneta(urano)">Urano</button>
  <button onclick="irPlaneta(neptuno)">Neptuno</button>
  <button onclick="irPlaneta(pluton)">Plutón</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/PointerLockControls.js"></script>

<script>
// ==================== ESCENA, CÁMARA, RENDERER ====================
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 40000);
camera.position.set(0,200,800);

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// ==================== TEXTURAS ====================
const loader = new THREE.TextureLoader();
const textures = {
  Sol: "https://i.postimg.cc/zGW5FLW0/sol.png",
  Mercurio: "https://i.postimg.cc/jSqQzfBG/mercurio.png",
  Venus: "https://i.postimg.cc/Znh60vrX/venus.png",
  Tierra: "https://i.postimg.cc/wTp1NdS6/image.png",
  Marte: "https://i.postimg.cc/x8S1LKp4/marte-textura.png",
  Júpiter: "https://i.postimg.cc/W3mvLxSq/jupiter_textura.png",
  Saturno: "https://i.postimg.cc/T1Wn3qLQ/saturno.png",
  Urano: "https://i.postimg.cc/dVFNgDp8/urano.png",
  Neptuno: "https://i.postimg.cc/HxFBzLb0/neptuno.png",
  Pluton: "https://i.postimg.cc/9QnVjPVX/pluton.png",
  LunaTierra: "https://i.postimg.cc/7hfrGbwg/luna.png",
  Fobos: "https://i.postimg.cc/7hfrGbwg/luna.png",
  Deimos: "https://i.postimg.cc/placeholder-deimos.png",
  LunaJupiter: "https://i.postimg.cc/7hfrGbwg/luna.png",
  LunaSaturno: "https://i.postimg.cc/7hfrGbwg/luna.png",
  LunaUrano: "https://i.postimg.cc/7hfrGbwg/luna.png",
  LunaNeptuno: "https://i.postimg.cc/7hfrGbwg/luna.png"
};

// ==================== LUZ ====================
const sunLight = new THREE.PointLight(0xffffff, 3);
sunLight.position.set(0,0,0);
scene.add(sunLight);

// ==================== SOL ====================
const sunGeo = new THREE.SphereGeometry(50,64,64);
const sunMat = new THREE.MeshBasicMaterial({ map: loader.load(textures.Sol) });
const sun = new THREE.Mesh(sunGeo, sunMat);
scene.add(sun);

// ==================== ESTRELLAS ====================
(function crearEstrellas(){
  const g = new THREE.BufferGeometry();
  const v = [];
  for(let i=0;i<50000;i++){
    v.push(THREE.MathUtils.randFloatSpread(40000));
    v.push(THREE.MathUtils.randFloatSpread(40000));
    v.push(THREE.MathUtils.randFloatSpread(40000));
  }
  g.setAttribute('position', new THREE.Float32BufferAttribute(v,3));
  scene.add(new THREE.Points(g,new THREE.PointsMaterial({size:1,color:0xffffff})));
})();

// ==================== CREAR PLANETAS ====================
function crearPlaneta(nombre, opciones){
  const geo = new THREE.SphereGeometry(opciones.radio,32,32);
  const mat = textures[nombre]
    ? new THREE.MeshStandardMaterial({ map: loader.load(textures[nombre]) })
    : new THREE.MeshStandardMaterial({ color: opciones.color });
  const mesh = new THREE.Mesh(geo, mat);
  mesh.name = nombre;
  mesh.userData = {
    distancia: opciones.distancia,
    angulo: Math.random()*Math.PI*2,
    velocidadOrbita: opciones.velOrb,
    velocidadRotacion: opciones.velRot
  };
  scene.add(mesh);
  return mesh;
}

// ==================== PLANETAS ====================
const mercurio = crearPlaneta("Mercurio", { color:0x909090, radio:4, distancia:150, velOrb:0.00005, velRot:0.0005 });
const venus    = crearPlaneta("Venus",    { color:0xffcc99, radio:6, distancia:220, velOrb:0.00004, velRot:0.0008 });
const tierra   = crearPlaneta("Tierra",   { color:0x00ff00, radio:8, distancia:300, velOrb:0.000035, velRot:0.001 });
const marte    = crearPlaneta("Marte",    { color:0xff0000, radio:5, distancia:380, velOrb:0.00003, velRot:0.0009 });
const jupiter  = crearPlaneta("Júpiter",  { color:0xff9966, radio:16, distancia:460, velOrb:0.00002, velRot:0.002 });
const saturno  = crearPlaneta("Saturno",  { color:0xffcc66, radio:14, distancia:540, velOrb:0.000015, velRot:0.0015 });
const urano    = crearPlaneta("Urano",    { color:0x66ccff, radio:12, distancia:600, velOrb:0.000012, velRot:0.0012 });
const neptuno  = crearPlaneta("Neptuno",  { color:0x3366ff, radio:12, distancia:660, velOrb:0.00001, velRot:0.001 });
const pluton   = crearPlaneta("Pluton",   { color:0x999999, radio:6, distancia:720, velOrb:0.000008, velRot:0.0007 });

// ==================== LUNAS ====================
function crearLuna(planet,nombre,radio,dist,vel){
  const l = new THREE.Mesh(
    new THREE.SphereGeometry(radio,16,16),
    new THREE.MeshStandardMaterial({ map: loader.load(textures[nombre]) })
  );
  l.userData = { orbita:planet, distancia:dist, velocidad:vel, angulo: Math.random()*Math.PI*2 };
  scene.add(l);
  return l;
}

const lunaTierra = crearLuna(tierra,"LunaTierra",1.8,12,0.01);
const fobos = crearLuna(marte,"Fobos",1.2,8,0.015);
const deimos = crearLuna(marte,"Deimos",0.8,12,0.007);
const lunaJupiter = crearLuna(jupiter,"LunaJupiter",3,25,0.003);
const lunaSaturno = crearLuna(saturno,"LunaSaturno",2,20,0.002);
const lunaUrano = crearLuna(urano,"LunaUrano",1.5,15,0.0015);
const lunaNeptuno = crearLuna(neptuno,"LunaNeptuno",1.5,15,0.001);

// ==================== ANILLOS ====================
const ringSaturno = new THREE.Mesh(
  new THREE.RingGeometry(16,22,64),
  new THREE.MeshBasicMaterial({ color:0xffffaa, side:THREE.DoubleSide, opacity:0.6, transparent:true })
);
ringSaturno.rotation.x = Math.PI/2;
scene.add(ringSaturno);

// ==================== CINTURÓN DE ASTEROIDES ====================
(function crearAsteroides(){
  const g = new THREE.BufferGeometry();
  const verts = [];
  for(let i=0;i<3000;i++){
    const a = Math.random()*Math.PI*2;
    const r = 420 + Math.random()*30;
    verts.push(Math.cos(a)*r, THREE.MathUtils.randFloatSpread(10), Math.sin(a)*r);
  }
  g.setAttribute('position', new THREE.Float32BufferAttribute(verts,3));
  scene.add(new THREE.Points(g,new THREE.PointsMaterial({ color:0x888888,size:0.5 })));
})();

// ==================== ÓRBITAS VISIBLES ====================
function crearOrbita(distancia){
  const geo = new THREE.RingGeometry(distancia-0.5, distancia+0.5, 64);
  const mat = new THREE.MeshBasicMaterial({ color:0xffffff, side:THREE.DoubleSide, opacity:0.15, transparent:true });
  const ring = new THREE.Mesh(geo, mat);
  ring.rotation.x = Math.PI/2;
  scene.add(ring);
  return ring;
}

const orbitas = [
  crearOrbita(150), crearOrbita(220), crearOrbita(300), crearOrbita(380),
  crearOrbita(460), crearOrbita(540), crearOrbita(600), crearOrbita(660),
  crearOrbita(720)
];

// ==================== CONTROLES ====================
const controls = new THREE.PointerLockControls(camera, document.body);
document.body.addEventListener('click', ()=>controls.lock());
const move = { f:false, b:false, l:false, r:false, up:false, down:false };
document.addEventListener('keydown',(e)=>{
  if(["KeyW","ArrowUp"].includes(e.code)) move.f=true;
  if(["KeyS","ArrowDown"].includes(e.code)) move.b=true;
  if(["KeyA","ArrowLeft"].includes(e.code)) move.l=true;
  if(["KeyD","ArrowRight"].includes(e.code)) move.r=true;
  if(["Space","KeyE"].includes(e.code)) move.up=true;
  if(["ShiftLeft","KeyQ"].includes(e.code)) move.down=true;
});
document.addEventListener('keyup',(e)=>{
  if(["KeyW","ArrowUp"].includes(e.code)) move.f=false;
  if(["KeyS","ArrowDown"].includes(e.code)) move.b=false;
  if(["KeyA","ArrowLeft"].includes(e.code)) move.l=false;
  if(["KeyD","ArrowRight"].includes(e.code)) move.r=false;
  if(["Space","KeyE"].includes(e.code)) move.up=false;
  if(["ShiftLeft","KeyQ"].includes(e.code)) move.down=false;
});

// ==================== FUNCIÓN BOTONES ====================
function irPlaneta(planeta){
  camera.position.set(planeta.position.x,planeta.position.y+10,planeta.position.z+planeta.userData.distancia*0.5);
}
function irSistemaSolar(){
  camera.position.set(0,200,800);
}

// ==================== ANIMACIÓN ====================
function animate(){
  requestAnimationFrame(animate);

  const speed = 5;
  if(move.f) controls.moveForward(speed);
  if(move.b) controls.moveForward(-speed);
  if(move.l) controls.moveRight(-speed);
  if(move.r) controls.moveRight(speed);
  if(move.up) camera.position.y += speed;
  if(move.down) camera.position.y -= speed;

  // Órbitas planetas y rotaciones
  [mercurio,venus,tierra,marte,jupiter,saturno,urano,neptuno,pluton].forEach(p=>{
    p.userData.angulo += p.userData.velocidadOrbita;
    p.position.x = Math.cos(p.userData.angulo)*p.userData.distancia;
    p.position.z = Math.sin(p.userData.angulo)*p.userData.distancia;
    p.rotation.y += p.userData.velocidadRotacion;
  });

  // Lunas
  [lunaTierra,fobos,deimos,lunaJupiter,lunaSaturno,lunaUrano,lunaNeptuno].forEach(l=>{
    l.userData.angulo += l.userData.velocidad;
    const o = l.userData.orbita.position;
    l.position.x = o.x + Math.cos(l.userData.angulo)*l.userData.distancia;
    l.position.z = o.z + Math.sin(l.userData.angulo)*l.userData.distancia;
  });

  // Anillo Saturno
  ringSaturno.position.x = saturno.position.x;
  ringSaturno.position.z = saturno.position.z;

  renderer.render(scene,camera);
}
animate();

// ==================== RESIZE ====================
window.addEventListener('resize', ()=>{
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>
</body>
</html>
